(function(e,t){typeof exports=="object"?module.exports=t(require("../core"),require("../time"),require("./Entity"),undefined,require("node-uuid")):typeof define=="function"&&define.amd&&define(["../core","../time","./Entity","./Image"],t)})(this,function(e,t,n,r,i){var s=function(t,n,s,o){this.uuid=o?o:i?i.v4():!1;var u={x:t+e.getRandomNumber(-25,25),y:n,speed:100,vx:100,vy:0,direction:s||1};this.set(u),this.y=n,this.width=50,this.height=30,this.color="rgba(0, 0, 255, 0.25)",this.image=r?new r("images/enemy.png"):!1,this.missiles=[],this.maxMissiles=5,this.range=50,this.origin={x:t,y:n},this.queue={},this.queue.server=[]};return s.prototype=new n,s.prototype.destroy=function(e,t){var n={};this.isHit=!0,n.isHit=this.isHit,this.vy=-200,n.vy=this.vy,typeof t=="function"&&t(this.uuid,n)},s.prototype.drawType=function(t){e.debug&&(this.isDestroyed&&(this.color="red"),t.ctx.fillStyle=this.color,t.ctx.fillRect(0,0,this.width,this.height),t.ctx.fill()),this.image.draw(t)},s.prototype.move=function(e,n){var r={};this.x+=this.vx*this.direction*t.delta,r.x=this.x,this.isHit?(this.y+=this.vy*t.delta,r.y=this.y,this.rotation+=20*t.delta,r.rotation=this.rotation,this.isDestroyed=this.y<-Math.max(this.height,this.width)):(this.x>this.origin.x+this.range?this.direction=-1:this.x<this.origin.x-this.range&&(this.direction=1),r.direction=this.direction),typeof n=="function"&&n(this.uuid,r)},s.prototype.interpolate=function(){var n=Math.abs(this.sx-this.x),r=Math.abs(this.sy-this.y),i=Math.max(n,r);if(!this.queue.server.length||i<.1)return;if(i>200){console.log(i),this.x=this.sx,this.y=this.sy;return}var s,o,u,a,f=this.queue.server.length-1,l,c;for(var h=0;h<f;h++){l=this.queue.server[h],c=this.queue.server[h+1];if(t.client>l.time&&t.client<c.time){u=l,a=c;break}}u||(u=a=this.queue.server[this.queue.server.length-1]);var p=0;if(u.time!==a.time){var i=u.time-t.client,d=u.time-a.time;p=i/d}a.x&&u.x&&(s=e.lerp(a.x,u.x,p),this.x=e.lerp(this.x,s,t.delta*e.smoothing)),a.y&&u.y&&(o=e.lerp(a.y,u.y,p),this.y=e.lerp(this.y,o,t.delta*e.smoothing))},s.prototype.getState=function(){return{uuid:this.uuid,state:{x:this.x,y:this.y,direction:this.direction}}},s});