(function(e,t){typeof exports=="object"?module.exports=t(require("../core.js"),require("../time.js"),require("./Rectangle"),require("node-uuid")):typeof define=="function"&&define.amd&&define(["../core","../time","./Rectangle"],t)})(this,function(e,t,n,r){var i=function(e){this.uuid=r?r.v4():!1;var t={speed:300,vy:0,y:0,x:0};this.set(t),this.width=10,this.height=20,this.ship=e,this.queue={},this.queue.server=[]};return i.prototype=new n,i.prototype.explode=function(e,t){var n={};this.vy=0,n.y=this.y,this.reload(e,t),typeof t=="function"&&t(this.uuid,n)},i.prototype.fire=function(e,t){var n={};this.ship&&(this.x=this.ship.x+this.ship.width/2-this.width/2,n.x=this.x,this.y=this.ship.y,n.y=this.y),this.vy=this.speed,n.vy=this.vy,this.isLive=!0,n.isLive=this.isLive,typeof t=="function"&&t(this.uuid,n)},i.prototype.move=function(e,n){var r={};this.y-=this.vy*t.delta,r.y=this.y,this.y<0-this.height&&this.reload(e,n),typeof n=="function"&&n(this.uuid,r)},i.prototype.reload=function(e,t){var n={};this.x=-this.height,n.x=this.x,this.ship&&(this.y=this.ship.y,n.y=this.y),this.isLive=!1,n.isLive=this.isLive,typeof t=="function"&&t(this.uuid,n)},i.prototype.interpolate=function(){var n=Math.abs(this.sy-this.y);if(!this.queue.server.length||n<.1)return;n>150&&(this.y=this.sy);var r,i,s,o,u=this.queue.server.length-1,a,f;for(var l=0;l<u;l++){a=this.queue.server[l],f=this.queue.server[l+1];if(t.client>a.time&&t.client<f.time){s=a,o=f;break}}s||(s=o=this.queue.server[this.queue.server.length-1]);var c=0;if(s.time!==o.time){var n=s.time-t.client,h=s.time-o.time;c=n/h}r=e.lerp(o.state.y,s.state.y,c),this.y=e.lerp(this.y,r,t.delta*e.smoothing),this.y<0-this.height&&this.reload()},i.prototype.getState=function(){return{uuid:this.uuid,state:{y:this.y,x:this.x,isLive:this.isLive}}},i});